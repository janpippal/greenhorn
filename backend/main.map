{"version":3,"sources":["webpack:///webpack/bootstrap 2dad335f6f5968cccd42","webpack:///external \"express\"","webpack:///./src/index.js","webpack:///external \"dotenv\"","webpack:///./src/server.js","webpack:///external \"body-parser\"","webpack:///external \"cors\"","webpack:///./src/rootRoutes.js","webpack:///./src/modules/auth/routes.js","webpack:///./src/modules/auth/authController.js","webpack:///./src/models/index.js","webpack:///external \"fs\"","webpack:///external \"path\"","webpack:///external \"sequelize\"","webpack:///./src/config/config.js","webpack:///external \"sequelize/lib/data-types\"","webpack:///./src/models/user.js","webpack:///./src/models/token.js","webpack:///external \"jsonwebtoken\"","webpack:///./src/logging.js","webpack:///external \"log4js\""],"names":["dotenv","config","PORT","process","env","setupLogging","app","listen","console","log","express","use","bodyParser","json","cors","__DEV__","static","rootRoutes","req","res","next","status","error","router","Router","authRoutes","post","authController","body","user","db","users","findAll","attributes","where","email","password","rejectOnEmpty","then","userJson","JSON","parse","stringify","token","jwt","sign","expiresIn","tokens","create","user_id","id","expiresAt","decode","exp","fields","catch","fs","require","path","Sequelize","__dirname","DataTypes","basename","__filename","sequelize","use_env_variable","database","username","modelModules","forEach","modelModule","model","name","Object","keys","modelName","associate","module","exports","define","STRING","role","INTEGER","DATE","log4js","configure","appenders","type","filename","replaceConsole"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 2dad335f6f5968cccd42","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 0\n// module chunks = 0","import dotenv from 'dotenv';\r\n\r\nimport { app } from './server';\r\n\r\nimport { setupLogging } from './logging';\r\n\r\ndotenv.config();\r\nconst { PORT = 3030 } = process.env;\r\n\r\nsetupLogging();\r\n\r\napp.listen(PORT, () => {\r\n  console.log(`Server started on http://localhost:${PORT}!`);\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 3\n// module chunks = 0","import bodyParser from 'body-parser';\r\nimport express from 'express';\r\nimport cors from 'cors';\r\n\r\nimport rootRoutes from './rootRoutes';\r\n\r\nexport const app = express();\r\n\r\napp.use(bodyParser.json());\r\napp.use(cors());\r\n\r\nif (__DEV__) {\r\n  app.use(express.static('public'));\r\n}\r\n\r\napp.use(rootRoutes);\r\n\r\napp.use((req, res, next) => {\r\n  res.status(404);\r\n  res.json({ error: '404: Not found' });\r\n});\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/server.js","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 5\n// module chunks = 0","module.exports = require(\"cors\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"cors\"\n// module id = 6\n// module chunks = 0","import { Router } from 'express';\r\n\r\nimport authRoutes from './modules/auth/routes';\r\n\r\nconst router = Router();\r\n\r\nrouter.use('/api/auth', authRoutes);\r\n\r\nexport default router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/rootRoutes.js","import { Router } from 'express';\r\n\r\nimport {\r\n  authController,\r\n} from './authController';\r\n\r\nconst router = Router();\r\nrouter.post('/', authController);\r\n\r\nexport default router;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/auth/routes.js","import db from '../../models/';\r\nimport jwt from 'jsonwebtoken';\r\n\r\nexport const authController = async (req, res, next) => {\r\n  const { body } = req;\r\n  const user = await db.users.findAll({\r\n  attributes: ['id','email','name','role'],\r\n  where: {\r\n    email: body.email,\r\n    password: body.password,\r\n  },\r\n  rejectOnEmpty: true\r\n}).then(user => {\r\n  const userJson = JSON.parse(JSON.stringify(user))[0]\r\n\r\n  const token = jwt.sign(userJson, 'shhhhh', {expiresIn: 60 * 60 * 24});\r\n\r\n  db.tokens.create({ user_id: userJson.id, token: token, expiresAt: jwt.decode(token,).exp}, { fields: [ 'user_id','token','expiresAt' ] })\r\n  return res.json({\r\n    user: userJson,\r\n    token: token\r\n  });\r\n})\r\n  .catch(() => {\r\n    return next();\r\n});\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/modules/auth/authController.js","const env = process.env.NODE_ENV || 'development';\r\n\r\nconst fs = require('fs');\r\nconst path = require('path');\r\nconst Sequelize = require('sequelize');\r\nconst config = require(__dirname + '/../config/config.js')[env];\r\nconst DataTypes = require('sequelize/lib/data-types');\r\n\r\nconst basename = path.basename(__filename);\r\n\r\nlet db = {};\r\nlet sequelize = {};\r\n\r\nif (config.use_env_variable) {\r\n  sequelize = new Sequelize(process.env[config.use_env_variable]);\r\n} else {\r\n  sequelize = new Sequelize(\r\n    config.database,\r\n    config.username,\r\n    config.password,\r\n    config\r\n  );\r\n}\r\n\r\n// Add all modules to this array\r\nconst modelModules = [\r\n  require('./user'),\r\n  require('./token'),\r\n];\r\n\r\nmodelModules.forEach(modelModule => {\r\n  const model = modelModule(sequelize, DataTypes);\r\n  db[model.name] = model;\r\n});\r\n\r\nObject.keys(db).forEach(modelName => {\r\n  if (db[modelName].associate) {\r\n    db[modelName].associate(db);\r\n  }\r\n});\r\n\r\ndb.sequelize = sequelize;\r\ndb.Sequelize = Sequelize;\r\n\r\nexport default db;\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/index.js","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 13\n// module chunks = 0","module.exports = {\r\n  \"development\": {\r\n    \"username\": \"root\",\r\n    \"password\": \"\",\r\n    \"database\": \"4it445\",\r\n    \"host\": \"localhost\",\r\n    \"dialect\": \"mysql\"\r\n  },\r\n  \"production\": {\r\n    \"username\": \"user\",\r\n    \"password\": \"pass\",\r\n    \"database\": \"user_xxx\",\r\n    \"host\": \"localhost\",\r\n    \"dialect\": \"mysql\"\r\n  }\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/config/config.js","module.exports = require(\"sequelize/lib/data-types\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize/lib/data-types\"\n// module id = 15\n// module chunks = 0","\r\nmodule.exports = (sequelize, DataTypes) => {\r\n  const users = sequelize.define(\r\n    'users',\r\n    {\r\n      email: DataTypes.STRING,\r\n      role: DataTypes.STRING,\r\n      name: DataTypes.STRING,\r\n      password: DataTypes.STRING,\r\n    },\r\n    {}\r\n  );\r\n  return users;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/user.js","\r\n\r\nmodule.exports = (sequelize, DataTypes) => {\r\n  const tokens = sequelize.define(\r\n    'tokens',\r\n    {\r\n      user_id: DataTypes.INTEGER,\r\n      token: DataTypes.STRING,\r\n      expiresAt: DataTypes.DATE,\r\n    },\r\n    {}\r\n  );\r\n  return tokens;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/models/token.js","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 18\n// module chunks = 0","import log4js from 'log4js';\r\n\r\nexport const setupLogging = () => {\r\n  log4js.configure({\r\n    appenders: [\r\n      { type: 'console' },\r\n      {\r\n        type: 'file',\r\n        filename: 'log/app.log',\r\n      },\r\n    ],\r\n    replaceConsole: true,\r\n  });\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/logging.js","module.exports = require(\"log4js\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"log4js\"\n// module id = 20\n// module chunks = 0"],"sourceRoot":""}